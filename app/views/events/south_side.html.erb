

<!--<div class="fixed-action-btn" style="bottom: 45px; right: 24px;">
  <%= link_to 'Back',  events_path, class: "waves-effect waves-light btn menubtn" %>
</div>-->

<div class="specials-header">
<h5 class="flow-text">Today's South Side Hours</h5>
<h4 class="flow-text"><%= @day_tag %></h4>


    <div class="search-tab-btn">
      <div class="click-open-search"> <i class="material-icons">search</i></div>
 <%= form_tag(south_side_path, :method => "get", id: "search-form") do %>
<!-- text field tag=action,args,identifier,placeholdertext... -->
<%= text_field_tag :search, params[:search], class: "search-query", placeholder: "Search Specials", type: "search", data: {autocomplete: south_side_autocomplete_event_special_path} %>

      <div class="search-btn">
<%= submit_tag "Search" %>
      </div>
<%end%>

<script type="text/javascript" charset="utf-8">
  $('#search').bind('railsAutocomplete.select', function(event, data){
  $('#search-form').submit()
  });
</script>
<%= link_to "clear", south_side_path%>

  </div>

<script>

  $( ".click-open-search" ).click(function() {
  $( ".search-tab-btn" ).toggleClass( "slide-out-search" );
});

  </script>



</div>


<div class="row" style="margin:0;">
    <div class="col s12 profile-tabs">
  <%if @b > 4 && @b < 20 %>
      <ul class="tabs">
        <li class="tab col s4"><a href="#venues">Venues</a></li>
        <li class="tab col s4"><a class="active" href="#specials">Hours</a></li>
        <%unless @daily_specials.empty?%>
        <li class="tab col s4"><a href="#featured-dish">Features</a></li>
        <%end%>
      </ul>
  <%else%>
      <ul class="tabs">
        <li class="tab col s4"><a class="active" href="#venues">Venues</a></li>
        <li class="tab col s4"><a href="#specials">Hours</a></li>
        <%unless @daily_specials.empty?%>
        <li class="tab col s4"><a href="#featured-dish">Features</a></li>
        <%end%>
      </ul>
   <%end%>
    </div>
  </div>

<!--TABS-->
<script>
   $(document).ready(function(){
    $('ul.tabs').tabs();
  });
</script>
<!--END TABS-->



<div class ="center" id="venues">
  <%=render partial: "shared/venue_index"%>
</div>
<div class ="center" id="specials">

  <div style="width: 100%;
    background: #f2f2f2;
    height: 60px;
    margin-top: 0px;
    padding: 20px;">
  <div class="now-tab" style="position: inherit; width: 45px; display:inline-block;">Now</div>
  <div class="later-tab" style="position: inherit; width: 45px; display:inline-block;">Later</div>
</div>

<%=render partial: "shared/dynamic_table_card"%>
</div>
<div class ="center" id="featured-dish">

  <div style="width: 100%;
    background: #f2f2f2;
    height: 60px;
    margin-top: 0px;
    padding: 20px;">
  <div class="now-tab" style="position: inherit; width: 45px; display:inline-block;">Now</div>
  <div class="later-tab" style="position: inherit; width: 45px; display:inline-block;">Later</div>
</div>


<%=render partial: "shared/featured_dish_table"%>
</div>

<!-- This script is for Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-77170385-1', 'auto');
  ga('send', 'pageview');

</script>

<div id="map"></div>

<script>
      function initMap() {
        // Get the location

if(navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
        var lat = position.coords.latitude;
        var lon = position.coords.longitude;
          var browserSupportFlag =  new Boolean();

        var bounds = new google.maps.LatLngBounds;
        var markersArray = [];

        var origin1 = {lat: lat, lng: lon};
        var destinationA = new google.maps.LatLng(<%=  Venue.where( id: @e[0].venue_id).first.latitude %>,<%=  Venue.where( id: @e[0].venue_id).first.longitude %>);

        var destinationIcon = 'https://chart.googleapis.com/chart?' +
            'chst=d_map_pin_letter&chld=D|FF0000|000000';
        var originIcon = 'https://chart.googleapis.com/chart?' +
            'chst=d_map_pin_letter&chld=O|FFFF00|000000';
        var map = new google.maps.Map(document.getElementById('map'), {
          center: new google.maps.LatLng(<%=  Venue.where( id: @e[0].venue_id).first.latitude %>,<%=  Venue.where( id: @e[0].venue_id).first.longitude %>),
          zoom: 10
        });

        var geocoder = new google.maps.Geocoder;
        var service = new google.maps.DistanceMatrixService;
        service.getDistanceMatrix({
          origins: [origin1],
          destinations: [destinationA],
          travelMode: google.maps.TravelMode.DRIVING,
          unitSystem: google.maps.UnitSystem.IMPERIAL,
          avoidHighways: false,
          avoidTolls: false
        }, function(response, status) {
          if (status !== google.maps.DistanceMatrixStatus.OK) {
            alert('Error was: ' + status);
          } else {
            var originList = response.originAddresses;
            var destinationList = response.destinationAddresses;
            var outputDiv = document.getElementById('output');
            outputDiv.innerHTML = '';
            deleteMarkers(markersArray);

            var showGeocodedAddressOnMap = function(asDestination) {
              var icon = asDestination ? destinationIcon : originIcon;
              return function(results, status) {
                if (status === google.maps.GeocoderStatus.OK) {
                  map.fitBounds(bounds.extend(results[0].geometry.location));
                  markersArray.push(new google.maps.Marker({
                    map: map,
                    position: results[0].geometry.location,
                    icon: icon
                  }));
                } else {
                  alert('Geocode was not successful due to: ' + status);
                }
              };
            };
            /*COPY THIS SECTION*/
            for (var i = 0; i < originList.length; i++) {
              var results = response.rows[i].elements;
              geocoder.geocode({'address': originList[i]},
                  showGeocodedAddressOnMap(false));
              for (var j = 0; j < results.length; j++) {
                geocoder.geocode({'address': destinationList[j]},
                    showGeocodedAddressOnMap(true));
                outputDiv.innerHTML +=
                    results[j].distance.text + ' away ' + '<br>';
                /*COPIED*/
              }
            }
          }
          });
        });
      }
     }


      function deleteMarkers(markersArray) {
        for (var i = 0; i < markersArray.length; i++) {
          markersArray[i].setMap(null);
        }
        markersArray = [];
      }

    </script>


<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDcCVvXtwQqi7U5DPCAKSguo4w8tFqRnxk&callback=initMap">
    </script>


